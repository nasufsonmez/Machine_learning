#
**Signal Extraction with TMVA**

**Overview**

This repository contains a script that utilizes the TMVA (Toolkit for Multivariate Analysis) from the ROOT CERN library to classify and extract signals from data generated by MADGRAPH/Pythia. The signal of interest involves proton-proton collisions resulting in the production of a single top quark, which decays into a charged Higgs instead of the usual W boson. The script applies various machine learning algorithms to distinguish this signal from the background.

**Features**

**Signal Generation**: The data is generated using POWHEG, PYTHIA and Delphes which simulates proton-proton collisions that produce single top quarks decaying into charged Higgs bosons.

**Background Modeling**: The background consists of standard physics events from proton-proton collisions, also simulated using MADGRAPH, PYTHIA and Delphes.

**Machine Learning**: The TMVA library provides a suite of multivariate methods, including:
1. **Decision Trees (BDT)**
2. **Artificial Neural Networks (ANN)**
3. **Support Vector Machines (SVM)**
4. **Deep Neural network (DNN)**
5. **Boosted Decision Trees (BDT)**
6. **Neural Networks (all are feed-forward Multilayer Perceptrons)**
7. **Neural Networks (all are feed-forward Multilayer Perceptrons)**
8. **Linear Discriminant Analysis**


These methods are employed to classify and extract the signal from the background data.

The full list of methods available are given below: 
<img width="1229" alt="Full list of methods available" src="https://github.com/user-attachments/assets/ab913255-d4e1-478c-bdc7-30b73717a8b2">

**Prerequisites**

**Software Requirements**:
**ROOT**: Install ROOT from the official website and ensure that the TMVA package is enabled. I used homebrew installation. 
https://root.cern/

Data :
Proton-proton collision data generated by MADGRAPH with single top quark production, leading to the charged Higgs boson decay channel.
<img width="1038" alt="The leaves in the data" src="https://github.com/user-attachments/assets/82869c4a-0e8c-4d72-9d4b-4c03294fb6f3">



**2. Running the TMVA Analysis**

The script runs various machine learning algorithms provided by TMVA to classify the events. To execute the script first compile it. 

```bash
# make TMVAClassification_bjet_gt_0_v2
```
then you can run the executable by providing which algorithm you want to use.
```
# ./TMVAClassification_bjet_gt_0_v2 Fisher LikelihoodPCA BDT DNN_CPU LD SVM
```

**3. Evaluating the Results**
Once the training and testing of the models are complete, the output will provide:

ROC Curves for each classifier
Signal vs Background Efficiency plots
Variable importance rankings
The trained models will help identify the likelihood that events are part of the signal (single top quark decaying to charged Higgs) or background.

**4. Output Files**
The script produces various output files:

**Classification performance reports** in text format.
**ROOT files** containing TMVA results and trained model weights.
**Plots and visualizations** to evaluate the efficiency and accuracy of the classification.

There is a **TMVAGui.C** script which visualise the results. Simply modify the the name of the output file in root. 
```
# root[]  TMVA::TMVAGui(“result.root”)
```
**Installation**:
Install ROOT and ensure TMVA is available.
Generate the proton-proton collision signal data using MADGRAPH.
Clone the repository:
bash
Copy code
git clone <repository_url>
cd <repository_folder>
How to Use the Script

**Customization**

Data Input: You can modify the data input section to accept other ROOT files generated from different processes or simulations.
Hyperparameters: Each machine learning algorithm’s hyperparameters can be tuned within the script to optimize the classification performance.
Algorithms: You can enable or disable specific TMVA methods by commenting/uncommenting lines in the configuration section.

**Future Improvements**

Advanced Model Integration: Expand the script to include deep learning methods via integration with TensorFlow or PyTorch.
Real Data Application: Adapt the script to apply the trained models to real collider data, such as from LHC experiments.
Additional Feature Engineering: Add new features and variables from the event data to improve classification performance.


**License**

This project is licensed under the MIT License. See the LICENSE file for more details.

**Some Plots Produced**
<img width="1048" alt="Correlation Matrix (background)" src="https://github.com/user-attachments/assets/85e6d12d-72e6-4ed1-89b1-da0c3e2dcc27">
<img width="1092" alt="Correlation Matrix (signal)" src="https://github.com/user-attachments/assets/56f14eea-f9f4-4934-b13e-3beb13db8704">
<img width="712" alt="TMVA response LD" src="https://github.com/user-attachments/assets/928deaaa-4a4f-4bcf-8173-6bd044711924">
<img width="712" alt="TMVA response SVM" src="https://github.com/user-attachments/assets/e6aa280e-a5fe-4c89-870a-8f06f4a6c0a4">
<img width="712" alt="TMVA response LikelihoodPCA" src="https://github.com/user-attachments/assets/dde219fb-1f25-4692-939c-390570ee3e9a">
<img width="712" alt="TMVA response Fisher" src="https://github.com/user-attachments/assets/fbf85ba1-2756-4d29-b273-f8be7519d421">
<img width="712" alt="TMVA response DNN_CPU" src="https://github.com/user-attachments/assets/931b7427-cef5-4a2f-b04e-398a732ba771">
<img width="712" alt="TMVA response BDT" src="https://github.com/user-attachments/assets/3af514ed-6eae-484f-8712-a0ba472a5cd4">

![overtrain_SVM](https://github.com/user-attachments/assets/ea14699d-ed4f-41cc-958a-1970ec85f11a)
![overtrain_LikelihoodPCA](https://github.com/user-attachments/assets/f8de4afb-e735-4e8b-a8e2-c0c56d20e4b9)
![overtrain_LD](https://github.com/user-attachments/assets/4df72064-0c01-43db-a253-d0782861eb41)
![overtrain_Fisher](https://github.com/user-attachments/assets/5675b68d-2241-46f0-96fd-c8119fffe190)
![overtrain_DNN_CPU](https://github.com/user-attachments/assets/a5c9b75d-6adc-4f3e-861a-05e20cedc7ea)
![overtrain_BDT](https://github.com/user-attachments/assets/347a76f5-a5f0-4ce5-8273-f6ac944c4e49)
![mvaeffs_SVM](https://github.com/user-attachments/assets/f275f3fa-496e-48da-9f0b-4e817447fac4)
![mvaeffs_LikelihoodPCA](https://github.com/user-attachments/assets/6f5902c6-b5b0-43c0-919d-5124e256ed4a)
![mvaeffs_LD](https://github.com/user-attachments/assets/83e189a2-1744-4e73-9c66-8c8a2bfb88dd)
![mvaeffs_Fisher](https://github.com/user-attachments/assets/1cb09068-b5b2-4be9-8c0f-3f3b52886d28)
![mvaeffs_DNN_CPU](https://github.com/user-attachments/assets/5c99707b-a11d-47f2-afdf-006b811f0471)
![mvaeffs_BDT](https://github.com/user-attachments/assets/4ac1120d-d2d8-4474-a040-c0119414c760)
![mva_SVM](https://github.com/user-attachments/assets/3f6f5374-c733-49f7-b1e5-85ee859e7130)
![mva_pdf_LD_c1](https://github.com/user-attachments/assets/2fb68e39-905f-4a80-b973-279a81e7d419)
![mva_pdf_Fisher_c2](https://github.com/user-attachments/assets/60964008-b587-4211-82b2-29c10439dfcf)
![mva_LikelihoodPCA](https://github.com/user-attachments/assets/6127c35b-ebfc-4aab-9df9-66c9f5d4ec94)
![mva_LD](https://github.com/user-attachments/assets/63d43bb6-85b2-46f9-93fe-22ef738ca6f6)
![mva_Fisher](https://github.com/user-attachments/assets/8c9ddd9d-2cad-4795-b614-6751551dd9da)
![mva_DNN_CPU](https://github.com/user-attachments/assets/ecb7a801-4779-4181-8c01-536ad0ec3739)
![mva_BDT](https://github.com/user-attachments/assets/a9daad69-0530-44e1-b025-ce2a89dae3d9)

![variables_id_c4](https://github.com/user-attachments/assets/ecda8cbb-1a09-4bbd-8e0e-096db45bf2c1)
![variables_id_c3](https://github.com/user-attachments/assets/14fb3c2c-b2b0-4084-9043-041ad16ed9f1)
![variables_id_c2](https://github.com/user-attachments/assets/87103793-256d-44ce-ad10-a0949d9ee6c0)
![variables_id_c1](https://github.com/user-attachments/assets/7419c57f-0a99-4e05-a809-c2a31fbb544a)

